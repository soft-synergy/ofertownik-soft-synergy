<!DOCTYPE html>
<html lang="{{lang}}" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{t.offerTitle}} — {{clientName}} — Soft Synergy</title>
    <script src="https://cdn.tailwindcss.com"></script>

    
<!-- Hotjar Tracking Code for Ofertownik -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:6506237,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="/generated-offers/logo-removebg-preview.png">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0d1117; color: #c9d1d9; overflow-x: hidden; }
        h1, h2, h3, h4, h5, h6 { font-family: 'Sora', sans-serif; color: #f0f6fc; }
        .gradient-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at 15% 25%, rgba(59, 130, 246, 0.1), transparent 30%), radial-gradient(circle at 85% 75%, rgba(168, 85, 247, 0.1), transparent 30%); animation: move-glow 15s ease-in-out infinite alternate; }
        @keyframes move-glow { from { background-position: 0% 0%; } to { background-position: 100% 100%; } }
        .glass-card { background: rgba(30, 41, 59, 0.5); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 1rem; }
        @media print { 
            .no-print { display: none !important; } 
            body { 
                background-color: white !important; 
                color: black !important; 
                margin: 0 !important;
                padding: 0 !important;
            } 
            .print-bg-white { background-color: #f3f4f6 !important; border: 1px solid #e5e7eb; } 
            .print-text-black { color: black !important; } 
            .print-text-gray { color: #374151 !important; } 
            h1, h2, h3, h4, h5, h6 { color: black !important; } 
            .gradient-bg { display: none !important; } 
            section { 
                page-break-inside: avoid; 
                margin-bottom: 20px !important;
            }
            .page-break { page-break-before: always; }
            .container { max-width: none !important; margin: 0 !important; padding: 20px !important; }
        }
        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1); }
        .reveal.visible { opacity: 1; transform: translateY(0); }
        .card-3d { transform-style: preserve-3d; transition: transform 0.5s cubic-bezier(0.165, 0.84, 0.44, 1); }
        .portfolio-carousel-container { position: relative; }
        .portfolio-carousel { display: flex; will-change: transform; }
        .portfolio-carousel:hover { animation-play-state: paused; }
        @media (max-width: 768px) {
            .portfolio-carousel-item { width: 100% !important; }
        }
        .testimonials-carousel-container { position: relative; }
        .testimonials-carousel { display: flex; will-change: transform; }
        .testimonials-carousel:hover { animation-play-state: paused; }
        @media (max-width: 768px) {
            .testimonial-item { width: 100% !important; }
        }
        .cookie-banner { 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            right: 0; 
            z-index: 1000; 
            background: rgba(30, 41, 59, 0.95); 
            backdrop-filter: blur(20px); 
            border-top: 1px solid rgba(255, 255, 255, 0.1); 
            padding: 1rem 1.5rem; 
            transform: translateY(100%); 
            transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        .cookie-banner.show { transform: translateY(0); }
        .exit-popup { 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            z-index: 2000; 
            background: rgba(0, 0, 0, 0.75); 
            backdrop-filter: blur(8px); 
            display: none; 
            align-items: center; 
            justify-content: center; 
            opacity: 0; 
            transition: opacity 0.3s ease;
        }
        .exit-popup.show { 
            display: flex; 
            opacity: 1;
        }
        .exit-popup-content {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        .exit-popup.show .exit-popup-content {
            transform: scale(1);
        }
    </style>
</head>
<body class="antialiased">
    <div class="gradient-bg"></div>
    <div class="max-w-5xl mx-auto p-4 md:p-8 lg:p-12">
        
        <header class="glass-card p-8 mb-16 reveal">
            <div class="flex justify-between items-start flex-wrap gap-6">
                <div class="flex items-center gap-4">
                    <img src="https://oferty.soft-synergy.com/generated-offers/logo-removebg-preview.png" alt="Soft Synergy Logo" class="w-20 h-20 object-contain">
                    <div>
                        <h1 class="text-4xl font-extrabold bg-gradient-to-r from-blue-500 via-purple-500 to-blue-600 bg-clip-text text-transparent">
                            Soft<span class="text-blue-500">Synergy</span>
                        </h1>
                        <p class="text-slate-400 print-text-gray font-medium">{{t.companyTagline}}</p>
                    </div>
                </div>
                <div class="text-left sm:text-right">
                    <h2 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">{{t.offerTitle}}</h2>
                    <p class="text-slate-400 print-text-gray mt-2">{{t.date}}: <span class="font-semibold text-slate-300 print-text-black">{{offerDate}}</span></p>
                    <p class="text-slate-400 print-text-gray">{{t.number}}: <span class="font-semibold text-slate-300 print-text-black">{{offerNumber}}</span></p>
                </div>
            </div>
            <div class="border-t border-white/10 my-6 h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-blue-600"></div>
            <div class="bg-gradient-to-r from-blue-600/10 to-purple-600/10 p-6 rounded-lg">
                <span class="text-slate-400 print-text-gray font-semibold">{{t.forLabel}}</span>
                <p class="text-xl font-bold text-white print-text-black">{{clientName}}</p>
                <p class="text-slate-300 print-text-gray font-medium">Do rąk: {{clientContact}}</p>
            </div>
        </header>

        <main class="space-y-24">
            
            {{#if (eq offerType 'preliminary')}}
            <!-- Special section for preliminary offers -->
            <section class="reveal">
                <div class="glass-card p-8 mb-8 border-l-4 border-yellow-500">
                    <h2 class="text-2xl font-bold mb-4 text-yellow-400">{{t.preliminaryTitle}}</h2>
                    <p class="text-slate-300 print-text-gray text-lg">{{t.preliminaryLead}}</p>
                </div>
            </section>
            {{/if}}

            <section class="reveal">
                <h2 class="text-3xl font-bold mb-4">{{t.greeting}}</h2>
                <div class="prose prose-invert max-w-none text-slate-300 text-lg leading-relaxed print-text-gray">
                    <p>Dziękujemy za poświęcony czas i inspirującą rozmowę na temat projektu <strong class="text-white print-text-black">{{projectName}}</strong>. W Soft Synergy rozumiemy, że Państwa celem jest nie tylko stworzenie aplikacji, ale strategiczne wzmocnienie pozycji rynkowej poprzez <strong class="text-white print-text-black">{{mainBenefit}}</strong>.</p>
                    <p>{{description}}</p>
                </div>
            </section>

            <!-- PROJECT GUARDIAN -->
            <section class="reveal">
                <h2 class="text-3xl font-bold mb-8 text-center">{{t.guardianTitle}}</h2>
                <div class="glass-card p-8 flex flex-col md:flex-row items-center gap-8 text-center md:text-left">
                    <div class="flex-shrink-0">
                        {{#if projectManager.avatar}}
                            <img src="https:///oferty.soft-synergy.com/generated-offers/jakub%20czajka.jpeg" alt="Zdjęcie {{projectManager.name}}" class="rounded-full w-32 h-32 md:w-40 md:h-40 object-cover border-4 border-blue-500 shadow-lg">
                        {{else}}
                            <img src="https://i.pravatar.cc/150?u={{projectManager.name}}" alt="Zdjęcie {{projectManager.name}}" class="rounded-full w-32 h-32 md:w-40 md:h-40 object-cover border-4 border-blue-500 shadow-lg">
                        {{/if}}
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold">{{projectManager.name}}</h3>
                        <p class="text-blue-400 font-semibold mb-4">{{projectManager.position}}</p>
                        <p class="text-slate-300 mb-4 print-text-gray">{{projectManager.description}}</p>
                        <div class="flex justify-center md:justify-start gap-6 text-slate-400 no-print">
                            <a href="mailto:{{projectManager.email}}" class="flex items-center gap-2 hover:text-white transition-colors">
                                <svg class="w-5 h-5" xmlns="https:///www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" /></svg>
                                <span>{{projectManager.email}}</span>
                            </a>
                            <a href="tel:{{projectManager.phone}}" class="flex items-center gap-2 hover:text-white transition-colors">
                                <svg class="w-5 h-5" xmlns="https:///www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.211-.998-.552-1.348l-5.116-4.423a1.125 1.125 0 00-1.554.269l-1.32 2.212a2.848 2.848 0 01-3.665-3.665l2.212-1.32a1.125 1.125 0 00.269-1.554l-4.423-5.116A1.125 1.125 0 006.128 2.25H4.5A2.25 2.25 0 002.25 4.5v2.25z" /></svg>
                                <span>{{projectManager.phone}}</span>
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <div class="page-break"></div>
            
            <section class="reveal">
                <h2 class="text-3xl font-bold mb-8 text-center">{{t.solutionScope}}</h2>
                <div class="space-y-8">
                    {{#each modules}}
                    <div class="glass-card p-6 flex items-start gap-6">
                        <div class="bg-{{#if color}}{{color}}{{else}}blue{{/if}}-500/20 text-{{#if color}}{{color}}{{else}}blue{{/if}}-400 font-bold text-2xl rounded-lg w-16 h-16 flex items-center justify-center flex-shrink-0">{{add @index 1}}</div>
                        <div>
                            <h3 class="text-xl font-bold mb-1">{{name}}</h3>
                            <p class="text-slate-400 print-text-gray">{{description}}</p>
                        </div>
                    </div>
                    {{/each}}
                </div>
            </section>
            
            <section class="reveal">
                <h2 class="text-3xl font-bold mb-8 text-center">{{t.timeline}}</h2>
                <div class="grid md:grid-cols-4 gap-x-8 gap-y-12 relative">
                    <div class="absolute top-5 left-0 w-full h-0.5 bg-white/20 hidden md:block"></div>
                    <div class="text-center relative">
                        <div class="w-10 h-10 bg-slate-700 rounded-full mx-auto flex items-center justify-center border-2 border-blue-500 mb-2">
                            <span class="font-bold">1</span>
                        </div>
                        <h4 class="font-bold">{{timeline.phase1.name}}</h4>
                        <p class="text-sm text-slate-400 print-text-gray">{{timeline.phase1.duration}}</p>
                    </div>
                    <div class="text-center relative">
                        <div class="w-10 h-10 bg-slate-700 rounded-full mx-auto flex items-center justify-center border-2 border-slate-500 mb-2">
                            <span class="font-bold">2</span>
                        </div>
                        <h4 class="font-bold">{{timeline.phase2.name}}</h4>
                        <p class="text-sm text-slate-400 print-text-gray">{{timeline.phase2.duration}}</p>
                    </div>
                    <div class="text-center relative">
                        <div class="w-10 h-10 bg-slate-700 rounded-full mx-auto flex items-center justify-center border-2 border-slate-500 mb-2">
                            <span class="font-bold">3</span>
                        </div>
                        <h4 class="font-bold">{{timeline.phase3.name}}</h4>
                        <p class="text-sm text-slate-400 print-text-gray">{{timeline.phase3.duration}}</p>
                    </div>
                    <div class="text-center relative">
                        <div class="w-10 h-10 bg-slate-700 rounded-full mx-auto flex items-center justify-center border-2 border-slate-500 mb-2">
                            <span class="font-bold">4</span>
                        </div>
                        <h4 class="font-bold">{{timeline.phase4.name}}</h4>
                        <p class="text-sm text-slate-400 print-text-gray">{{timeline.phase4.duration}}</p>
                    </div>
                </div>
            </section>
            
            <div class="page-break"></div>
            
            <section class="reveal">
                <h2 class="text-3xl font-bold mb-8 text-center">{{t.investment}}</h2>
                <div class="glass-card overflow-hidden print-bg-white">
                    <table class="w-full text-left">
                        <thead class="bg-white/5">
                            <tr>
                                <th class="p-5 font-semibold">{{t.tableStage}}</th>
                                <th class="p-5 text-right font-semibold">{{t.tableCost}}</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-white/10">
                            <tr class="hover:bg-white/5">
                                <td class="p-5 font-medium print-text-gray">{{timeline.phase1.name}}</td>
                                <td class="p-5 text-right font-semibold text-slate-300 print-text-black">{{formatCurrency pricing.phase1}}</td>
                            </tr>
                            <tr class="hover:bg-white/5">
                                <td class="p-5 font-medium print-text-gray">{{timeline.phase2.name}}</td>
                                <td class="p-5 text-right font-semibold text-slate-300 print-text-black">{{formatCurrency pricing.phase2}}</td>
                            </tr>
                            <tr class="hover:bg-white/5">
                                <td class="p-5 font-medium print-text-gray">{{timeline.phase3.name}}</td>
                                <td class="p-5 text-right font-semibold text-slate-300 print-text-black">{{formatCurrency pricing.phase3}}</td>
                            </tr>
                            <tr class="hover:bg-white/5">
                                <td class="p-5 font-medium print-text-gray">{{timeline.phase4.name}}</td>
                                <td class="p-5 text-right font-semibold text-slate-300 print-text-black">{{formatCurrency pricing.phase4}}</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr class="bg-blue-600/80">
                                <td class="p-5 text-right font-bold text-lg text-white">{{t.totalNet}}</td>
                                <td class="p-5 text-right font-extrabold text-2xl text-white">
                                    {{#if priceRange.min}}
                                        {{#if priceRange.max}}
                                            {{formatCurrency priceRange.min}} - {{formatCurrency priceRange.max}}
                                        {{else}}
                                            od {{formatCurrency priceRange.min}}
                                        {{/if}}
                                    {{else}}
                                        {{formatCurrency pricing.total}}
                                    {{/if}}
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                <div class="mt-8 grid md:grid-cols-2 gap-8">
                    <div class="glass-card p-6">
                        <h4 class="font-bold text-lg mb-2">{{t.paymentTerms}}</h4>
                        <p class="text-slate-400 print-text-gray">{{#if customPaymentTerms}}{{customPaymentTerms}}{{else}}10% zaliczki po podpisaniu umowy.<br>90% po odbiorze końcowym projektu.{{/if}}</p>
                    </div>
                    <div class="glass-card p-6">
                        <h4 class="font-bold text-lg mb-2">{{t.warrantySupport}}</h4>
                        <p class="text-slate-400 print-text-gray">{{t.warrantySupportContent}}</p>
                    </div>
                </div>
            </section>
            
            {{#if portfolio}}
            <section class="reveal">
                <h2 class="text-3xl font-bold mb-8 text-center">{{t.portfolioTitle}}</h2>
                {{#if (gt (length portfolio) 2)}}
                <!-- Carousel for 3+ items -->
                <div class="portfolio-carousel-container relative overflow-hidden">
                    <div class="portfolio-carousel flex gap-8 transition-transform duration-700 ease-in-out" style="transform: translateX(0);">
                        {{#each portfolio}}
                        <div class="portfolio-carousel-item flex-shrink-0 w-full md:w-1/2 lg:w-1/3">
                            <div class="card-3d group">
                                <div class="glass-card overflow-hidden transition-all duration-500 group-hover:shadow-2xl group-hover:shadow-blue-500/20">
                                    <img src="https:///oferty.soft-synergy.com{{this.image}}" alt="{{this.title}}" class="w-full h-56 object-cover transition-transform duration-500 group-hover:scale-105" onerror="this.src='https:///via.placeholder.com/400x300?text=No+Image'" crossorigin="anonymous">
                                    <div class="p-6">
                                        <h3 class="text-xl font-bold mb-1">{{this.title}}</h3>
                                        <p class="text-slate-400 text-sm print-text-gray">{{this.description}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {{/each}}
                    </div>
                    <div class="portfolio-carousel-dots flex justify-center gap-2 mt-6 no-print">
                        {{#each portfolio}}
                        <button class="carousel-dot w-2 h-2 rounded-full bg-white/30 transition-all {{#if @first}}bg-blue-500 w-8{{/if}}" data-index="{{@index}}"></button>
                        {{/each}}
                    </div>
                </div>
                {{else}}
                <!-- Grid for 1-2 items -->
                <div class="grid md:grid-cols-2 gap-8" style="perspective: 1000px;">
                    {{#each portfolio}}
                    <div class="card-3d group">
                        <div class="glass-card overflow-hidden transition-all duration-500 group-hover:shadow-2xl group-hover:shadow-blue-500/20">
                            <img src="https:///oferty.soft-synergy.com{{this.image}}" alt="{{this.title}}" class="w-full h-56 object-cover transition-transform duration-500 group-hover:scale-105" onerror="this.src='https:///via.placeholder.com/400x300?text=No+Image'" crossorigin="anonymous">
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-1">{{this.title}}</h3>
                                <p class="text-slate-400 text-sm print-text-gray">{{this.description}}</p>
                            </div>
                        </div>
                    </div>
                    {{/each}}
                </div>
                {{/if}}
                <div class="flex justify-center mt-8">
                    <a href="https://soft-synergy.com/portfolio" target="_blank" rel="noopener" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg transition-all duration-300 hover:bg-blue-500 hover:shadow-2xl hover:shadow-blue-500/40 transform hover:-translate-y-1">
                        {{t.seeMorePortfolio}}
                    </a>
                </div>
            </section>
            {{/if}}
            
            <!-- Technologies and Methodologies Section -->
            {{#if technologies}}
            <section class="reveal">
                <h2 class="text-3xl font-bold mb-8 text-center">{{t.technologiesTitle}}</h2>
                <div class="p-8">
                    {{#if technologies.stack}}
                    <div class="mb-8">
                        <h3 class="text-xl font-bold mb-6 text-blue-400 flex items-center gap-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                            </svg>
                            {{t.techStack}}
                        </h3>
                        <div class="flex flex-wrap gap-3">
                            {{#each technologies.stack}}
                            <span class="px-5 py-2.5 bg-gradient-to-r from-blue-600/20 to-blue-500/20 text-blue-300 rounded-lg border border-blue-500/40 font-medium backdrop-blur-sm hover:border-blue-400/60 transition-colors">{{this}}</span>
                            {{/each}}
                        </div>
                    </div>
                    {{/if}}
                    {{#if technologies.methodologies}}
                    <div>
                        <h3 class="text-xl font-bold mb-6 text-purple-400 flex items-center gap-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                            </svg>
                            {{t.methodologies}}
                        </h3>
                        <div class="flex flex-wrap gap-3">
                            {{#each technologies.methodologies}}
                            <span class="px-5 py-2.5 bg-gradient-to-r from-purple-600/20 to-purple-500/20 text-purple-300 rounded-lg border border-purple-500/40 font-medium backdrop-blur-sm hover:border-purple-400/60 transition-colors">{{this}}</span>
                            {{/each}}
                        </div>
                    </div>
                    {{/if}}
                </div>
            </section>
            {{/if}}
            
            <!-- Testimonials and Stats Section -->
            <section class="reveal">
                <div class="p-12 text-center">
                    <div class="mb-12">
                        <h2 class="text-5xl font-extrabold bg-gradient-to-r from-blue-500 via-purple-500 to-blue-600 bg-clip-text text-transparent mb-4">
                            250+
                        </h2>
                        <p class="text-2xl font-bold text-white print-text-black mb-2">{{t.projectsCompleted}}</p>
                        <p class="text-slate-400 print-text-gray">{{t.projectsCompletedDesc}}</p>
                    </div>
                    
                    {{#if testimonials}}
                    <!-- Testimonials Carousel -->
                    <div class="testimonials-carousel-container relative overflow-hidden mt-8">
                        <div class="testimonials-carousel flex gap-6 transition-transform duration-700 ease-in-out" style="transform: translateX(0);">
                            {{#each testimonials}}
                            <div class="testimonial-item flex-shrink-0 w-full md:w-1/2 lg:w-1/3">
                                <div class="p-6 text-left h-full border border-white/10 hover:border-blue-500/30 transition-all rounded-lg bg-white/5 backdrop-blur-sm">
                                    <div class="flex items-center mb-4">
                                        {{#each (range 1 5)}}
                                        <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                        </svg>
                                        {{/each}}
                                    </div>
                                    <p class="text-slate-300 print-text-gray mb-6 italic leading-relaxed">"{{this.quote}}"</p>
                                    <div class="border-t border-white/10 pt-4">
                                        <p class="font-semibold text-white print-text-black">{{this.author}}</p>
                                        <p class="text-sm text-slate-400 print-text-gray mt-1">{{this.role}}</p>
                                    </div>
                                </div>
                            </div>
                            {{/each}}
                        </div>
                        <div class="testimonials-carousel-dots flex justify-center gap-2 mt-8 no-print">
                            {{#each testimonials}}
                            <button class="testimonial-dot w-2 h-2 rounded-full bg-white/30 transition-all {{#if @first}}bg-blue-500 w-8{{/if}}" data-index="{{@index}}"></button>
                            {{/each}}
                        </div>
                    </div>
                    {{/if}}
                </div>
            </section>
            
            <section class="reveal text-center">
                <h2 class="text-3xl font-bold mb-4">{{t.nextSteps}}</h2>
                {{#if (eq offerType 'preliminary')}}
                <p class="max-w-2xl mx-auto text-slate-300 mb-8 print-text-gray">{{t.prelimNextStepsLead}}</p>
                <ol class="text-left max-w-md mx-auto space-y-4 mb-12">
                    <li class="flex items-center gap-4">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-600 font-bold">1</span>
                        <span>{{t.prelimStep1}}</span>
                    </li>
                    <li class="flex items-center gap-4">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full bg-slate-700 font-bold">2</span>
                        <span>{{t.prelimStep2}}</span>
                    </li>
                    <li class="flex items-center gap-4">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full bg-slate-700 font-bold">3</span>
                        <span>{{t.prelimStep3}}</span>
                    </li>
                </ol>
                {{else}}
                <p class="max-w-2xl mx-auto text-slate-300 mb-8 print-text-gray">{{t.finalNextStepsLead}}</p>
                <ol class="text-left max-w-md mx-auto space-y-4 mb-12">
                    <li class="flex items-center gap-4">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-600 font-bold">1</span>
                        <span>{{t.finalStep1}}</span>
                    </li>
                    <li class="flex items-center gap-4">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full bg-slate-700 font-bold">2</span>
                        <span>{{t.finalStep2}}</span>
                    </li>
                    <li class="flex items-center gap-4">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full bg-slate-700 font-bold">3</span>
                        <span>{{t.finalStep3}}</span>
                    </li>
                </ol>
                {{/if}}
                <div class="flex flex-col md:flex-row justify-center items-center gap-6 no-print">
                    {{#if (eq offerType 'preliminary')}}
                    <a href="mailto:{{companyEmail}}?subject={{t.prelimCta}} - {{offerNumber}} {{clientName}}" class="w-full md:w-auto bg-blue-600 text-white font-bold text-lg py-3 px-8 rounded-lg transition-all duration-300 hover:bg-blue-500 hover:shadow-2xl hover:shadow-blue-500/40 transform hover:-translate-y-1">{{t.prelimCta}}</a>
                    {{else}}
                    <a href="mailto:{{companyEmail}}?subject={{t.finalCta}} - {{offerNumber}} {{clientName}}" class="w-full md:w-auto bg-blue-600 text-white font-bold text-lg py-3 px-8 rounded-lg transition-all duration-300 hover:bg-blue-500 hover:shadow-2xl hover:shadow-blue-500/40 transform hover:-translate-y-1">{{t.finalCta}}</a>
                    {{/if}}
                    {{#if pdfUrl}}
                    <a href="https://oferty.soft-synergy.com{{pdfUrl}}" target="_blank" rel="noopener" class="w-full md:w-auto bg-white/10 text-white font-semibold py-3 px-8 rounded-lg transition-colors hover:bg-white/20">{{t.downloadOffer}}</a>
                    {{else}}
                    <button class="w-full md:w-auto bg-white/10 text-white font-semibold py-3 px-8 rounded-lg transition-colors hover:bg-white/20" id="okej">{{t.downloadOffer}}</button>
                    {{/if}}
                </div>
            </section>
        </main>
        
        <footer class="text-center py-12 mt-16 from-transparent to-blue-500/5">
            <div class="flex items-center justify-center gap-4 mb-4">
                <img src="https://oferty.soft-synergy.com/generated-offers/logo-removebg-preview.png" alt="Soft Synergy Logo" class="w-12 h-12 object-contain">
                <h3 class="text-2xl font-extrabold bg-gradient-to-r from-blue-500 via-purple-500 to-blue-600 bg-clip-text text-transparent">
                    Soft<span class="text-blue-500">Synergy</span>
                </h3>
            </div>
            <p class="text-sm text-slate-400 print-text-gray mb-2">Innowacyjne rozwiązania programistyczne</p>
            <p class="text-sm text-slate-300 print-text-gray font-medium">{{companyEmail}} | {{companyPhone}}</p>
            <div class="max-w-2xl mx-auto mt-8 text-left text-xs text-slate-400 print-text-gray bg-white/5 rounded-lg p-4 border border-white/10">
                <h3 class="font-bold mb-2 text-slate-300 print-text-black">{{t.reservations}}</h3>
                <ul class="list-disc pl-5 space-y-1">
                    <li>{{t.res1}}</li>
                    <li>{{t.res2}}</li>
                    <li>{{t.res3}}</li>
                    {{#if customReservations}}
                        {{#each customReservations}}
                            <li>{{this}}</li>
                        {{/each}}
                    {{/if}}
                </ul>
            </div>
            <div class="mt-6 flex items-center justify-center gap-4 text-xs text-slate-500 print-text-gray">
                <span>© 2024 Soft Synergy</span>
                <span>•</span>
                <span>Wszystkie prawa zastrzeżone</span>
            </div>
        </footer>
    </div>

    <!-- Cookie Consent Banner -->
    <div class="cookie-banner no-print" id="cookieBanner">
        <div class="max-w-5xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex-1 text-sm text-slate-300">
                <p>Ta strona używa plików cookie, aby zapewnić najlepsze wrażenia. Kontynuując przeglądanie, zgadzasz się na ich użycie.</p>
            </div>
            <div class="flex items-center gap-3">
                <button id="cookieAccept" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-500 transition-colors">
                    Akceptuję
                </button>
                <button id="cookieDecline" class="bg-white/10 text-white font-semibold py-2 px-6 rounded-lg hover:bg-white/20 transition-colors">
                    Odrzuć
                </button>
            </div>
        </div>
    </div>

    <!-- Exit Intent Popup -->
    <div class="exit-popup no-print" id="exitPopup">
        <div class="exit-popup-content text-center">
            <div class="mb-6">
                <h3 class="text-2xl font-bold text-white mb-3">Zostań jeszcze chwilę!</h3>
                <p class="text-slate-300 mb-4">
                    Jeśli masz jeszcze pytania lub wątpliwości dotyczące naszej oferty, umówmy się na <strong class="text-blue-400">bezpłatne spotkanie online</strong>.
                </p>
                <p class="text-slate-400 text-sm mb-6">
                    Podczas spotkania omówimy szczegóły projektu i odpowiemy na wszystkie Twoje pytania.
                </p>
            </div>
            <div class="flex flex-col sm:flex-row gap-3 justify-center">
                <a href="https://cal.com/soft-synergy/30min" target="_blank" rel="noopener" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 px-8 rounded-lg hover:from-blue-500 hover:to-purple-500 transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-blue-500/40">
                    Umów spotkanie online
                </a>
                <button id="exitCloseBtn" class="bg-white/10 text-white font-semibold py-3 px-8 rounded-lg hover:bg-white/20 transition-colors">
                    Zamknij
                </button>
            </div>
        </div>
    </div>

    <script>
        // Cookie Consent Functions (global - must be defined before DOMContentLoaded)
        window.acceptCookies = function() {
            localStorage.setItem('cookieConsent', 'accepted');
            const banner = document.getElementById('cookieBanner');
            if (banner) {
                banner.classList.remove('show');
            }
        };

        window.declineCookies = function() {
            localStorage.setItem('cookieConsent', 'declined');
            const banner = document.getElementById('cookieBanner');
            if (banner) {
                banner.classList.remove('show');
            }
        };

        // Exit Popup Functions (global - must be defined before DOMContentLoaded)
        let exitIntentShown = false;

        window.showExitPopup = function() {
            const exitConsent = localStorage.getItem('exitIntentShown');
            if (!exitIntentShown && !exitConsent) {
                const popup = document.getElementById('exitPopup');
                if (popup) {
                    popup.classList.add('show');
                }
            }
        };

        window.closeExitPopup = function() {
            const popup = document.getElementById('exitPopup');
            if (popup) {
                popup.classList.remove('show');
            }
            exitIntentShown = true;
            localStorage.setItem('exitIntentShown', 'true');
        };

        document.addEventListener('DOMContentLoaded', () => {
            console.log('Strona została załadowana');
            

            
            const observer = new IntersectionObserver((entries) => { 
                entries.forEach(entry => { 
                    if (entry.isIntersecting) { 
                        entry.target.classList.add('visible'); 
                        observer.unobserve(entry.target); 
                    } 
                }); 
            }, { threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
            const cards = document.querySelectorAll('.card-3d');
            cards.forEach(card => { 
                card.addEventListener('mousemove', (e) => { 
                    const rect = card.getBoundingClientRect(); 
                    const x = e.clientX - rect.left; 
                    const y = e.clientY - rect.top; 
                    const rotateX = ((y - rect.height / 2) / (rect.height / 2)) * -4; 
                    const rotateY = ((x - rect.width / 2) / (rect.width / 2)) * 4; 
                    card.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`; 
                }); 
                card.addEventListener('mouseleave', () => { 
                    card.style.transform = 'rotateX(0deg) rotateY(0deg)'; 
                }); 
            });

            // Portfolio Carousel Auto-Scroll
            const carouselContainer = document.querySelector('.portfolio-carousel-container');
            if (carouselContainer) {
                const carousel = carouselContainer.querySelector('.portfolio-carousel');
                const items = carouselContainer.querySelectorAll('.portfolio-carousel-item');
                const dots = carouselContainer.querySelectorAll('.carousel-dot');
                if (items.length > 2) {
                    let currentIndex = 0;
                    let isPaused = false;
                    const itemWidth = items[0].offsetWidth + 32; // width + gap
                    
                    // Auto-scroll function
                    const scrollCarousel = () => {
                        if (isPaused) return;
                        
                        currentIndex = (currentIndex + 1) % items.length;
                        const translateX = -currentIndex * itemWidth;
                        carousel.style.transform = `translateX(${translateX}px)`;
                        
                        // Update dots
                        dots.forEach((dot, idx) => {
                            if (idx === currentIndex) {
                                dot.classList.add('bg-blue-500', 'w-8');
                                dot.classList.remove('bg-white/30');
                            } else {
                                dot.classList.remove('bg-blue-500', 'w-8');
                                dot.classList.add('bg-white/30');
                            }
                        });
                    };
                    
                    // Pause on hover
                    carouselContainer.addEventListener('mouseenter', () => {
                        isPaused = true;
                    });
                    carouselContainer.addEventListener('mouseleave', () => {
                        isPaused = false;
                    });
                    
                    // Dot navigation
                    dots.forEach((dot, idx) => {
                        dot.addEventListener('click', () => {
                            currentIndex = idx;
                            const translateX = -currentIndex * itemWidth;
                            carousel.style.transform = `translateX(${translateX}px)`;
                            
                            dots.forEach((d, i) => {
                                if (i === currentIndex) {
                                    d.classList.add('bg-blue-500', 'w-8');
                                    d.classList.remove('bg-white/30');
                                } else {
                                    d.classList.remove('bg-blue-500', 'w-8');
                                    d.classList.add('bg-white/30');
                                }
                            });
                        });
                    });
                    
                    // Start auto-scroll
                    setInterval(scrollCarousel, 4000); // Change slide every 4 seconds
                }
            }

            // Testimonials Carousel Auto-Scroll
            const testimonialsContainer = document.querySelector('.testimonials-carousel-container');
            if (testimonialsContainer) {
                const carousel = testimonialsContainer.querySelector('.testimonials-carousel');
                const items = testimonialsContainer.querySelectorAll('.testimonial-item');
                const dots = testimonialsContainer.querySelectorAll('.testimonial-dot');
                if (items.length > 1) {
                    let currentIndex = 0;
                    let isPaused = false;
                    const itemWidth = items[0].offsetWidth + 24; // width + gap
                    
                    // Auto-scroll function
                    const scrollTestimonials = () => {
                        if (isPaused) return;
                        
                        currentIndex = (currentIndex + 1) % items.length;
                        const translateX = -currentIndex * itemWidth;
                        carousel.style.transform = `translateX(${translateX}px)`;
                        
                        // Update dots
                        dots.forEach((dot, idx) => {
                            if (idx === currentIndex) {
                                dot.classList.add('bg-blue-500', 'w-8');
                                dot.classList.remove('bg-white/30');
                            } else {
                                dot.classList.remove('bg-blue-500', 'w-8');
                                dot.classList.add('bg-white/30');
                            }
                        });
                    };
                    
                    // Pause on hover
                    testimonialsContainer.addEventListener('mouseenter', () => {
                        isPaused = true;
                    });
                    testimonialsContainer.addEventListener('mouseleave', () => {
                        isPaused = false;
                    });
                    
                    // Dot navigation
                    dots.forEach((dot, idx) => {
                        dot.addEventListener('click', () => {
                            currentIndex = idx;
                            const translateX = -currentIndex * itemWidth;
                            carousel.style.transform = `translateX(${translateX}px)`;
                            
                            dots.forEach((d, i) => {
                                if (i === currentIndex) {
                                    d.classList.add('bg-blue-500', 'w-8');
                                    d.classList.remove('bg-white/30');
                                } else {
                                    d.classList.remove('bg-blue-500', 'w-8');
                                    d.classList.add('bg-white/30');
                                }
                            });
                        });
                    });
                    
                    // Start auto-scroll
                    setInterval(scrollTestimonials, 5000); // Change slide every 5 seconds
                }
            }
        });

        function downloadHTML(event) {
            console.log('Funkcja downloadHTML została wywołana');
            
            // Pokaż loading na przycisku
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Przygotowuję...';
            button.disabled = true;
            
            try {
                // Pobierz aktualną zawartość strony
                const htmlContent = document.documentElement.outerHTML;
                
                // Stwórz blob z zawartością HTML
                const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
                
                // Stwórz link do pobrania
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(blob);
                downloadLink.download = `oferta-{{offerNumber}}-{{clientName}}.html`;
                
                // Dodaj link do DOM i kliknij go
                document.body.appendChild(downloadLink);
                downloadLink.click();
                
                // Usuń link
                document.body.removeChild(downloadLink);
                
                // Przywróć przycisk
                button.textContent = originalText;
                button.disabled = false;
                
                // Pokaż komunikat sukcesu
                setTimeout(() => {
                    button.textContent = 'Pobrano!';
                    setTimeout(() => {
                        button.textContent = originalText;
                    }, 1000);
                }, 500);
                
            } catch (error) {
                console.error('Błąd podczas pobierania HTML:', error);
                button.textContent = 'Błąd - spróbuj ponownie';
                button.disabled = false;
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.disabled = false;
                }, 3000);
            }
        }
        

        // Download button event listener (only if button exists)
        const downloadBtn = document.getElementById('okej');
        if (downloadBtn) {
            downloadBtn.addEventListener('click', downloadHTML);
        }

        // Cookie banner buttons (no inline handlers due to CSP)
        const cookieAcceptBtn = document.getElementById('cookieAccept');
        if (cookieAcceptBtn) {
            cookieAcceptBtn.addEventListener('click', window.acceptCookies);
        }
        const cookieDeclineBtn = document.getElementById('cookieDecline');
        if (cookieDeclineBtn) {
            cookieDeclineBtn.addEventListener('click', window.declineCookies);
        }

        // Exit popup close button
        const exitCloseBtn = document.getElementById('exitCloseBtn');
        if (exitCloseBtn) {
            exitCloseBtn.addEventListener('click', window.closeExitPopup);
        }

        // Check if cookie consent was already given
        const cookieConsent = localStorage.getItem('cookieConsent');
        if (!cookieConsent) {
            setTimeout(() => {
                const banner = document.getElementById('cookieBanner');
                if (banner) {
                    banner.classList.add('show');
                }
            }, 2000); // Show after 2 seconds
        }

        // Exit Intent Detection
        const exitConsent = localStorage.getItem('exitIntentShown');
        
        // Detect exit intent (mouse leaving top of page)
        document.addEventListener('mouseout', (e) => {
            if (!e.toElement && !e.relatedTarget && e.clientY < 10 && !exitIntentShown && !exitConsent) {
                window.showExitPopup();
            }
        });

        // Also detect on mobile (when user tries to go back)
        let touchStartY = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
        });

        document.addEventListener('touchmove', (e) => {
            if (!exitIntentShown && !exitConsent) {
                const touchY = e.touches[0].clientY;
                // If user swipes up from very bottom, show popup
                if (touchStartY > window.innerHeight - 50 && touchY < touchStartY - 100) {
                    window.showExitPopup();
                }
            }
        });

        // Close popup on ESC key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                window.closeExitPopup();
            }
        });

        // Close popup when clicking outside (only if popup exists)
        const exitPopup = document.getElementById('exitPopup');
        if (exitPopup) {
            exitPopup.addEventListener('click', (e) => {
                if (e.target.id === 'exitPopup') {
                    window.closeExitPopup();
                }
            });
        }
    </script>
</body>
</html> 